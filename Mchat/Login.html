<html lang="zh-CN">
<head>
<title>Mchat - 登陆注册</title>
<meta charset="utf-8">
<meta name="referrer" content="no-referrer"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
<link rel="icon" href="../favicon.ico"/>
<link rel="stylesheet" href="../start/index.css"/>
<link rel="stylesheet" href="../start/mdui/css/mdui.min.css"/>
<link rel="stylesheet" href="../start/bootstrap/css/bootstrap.min.css"/>
<script src="../start/origin.js"></script>
<script src="../start/mdui/js/mdui.min.js"></script>
<script src="../start/bootstrap/js/bootstrap.bundle.min.js"></script>
</head>
<body class="mdui-appbar-with-toolbar mdui-appbar-with-tab container container-fluid">
<div class="row text-center"><div class="col-10 col-sm-6 col-md-4 d-grid gap-2 mx-auto">
<div class="mb-5"></div>

<!-- 登录 -->
<div id="hidden" class="shadow-lg p-3 mb-5 bg-body-tertiary rounded card-body font-monospace">
<h5 class="card-title text-center">用 Mchat 账户登录</h5>
<div class="mb-3">
<input class="form-control" type="text" id="username" name="username" placeholder="账号">
</div>
<div class="mb-3">
<input class="form-control" type="password" id="password" name="password" placeholder="密码">
</div>
<div class="d-grid gap-2 col-6 mx-auto">
<button type="submit" id="login-form" class="btn btn-outline-secondary">登录</button>
</div>
<div class="mb-3"></div>
<div class="mb-1 text-center text-muted">
还没有 Mchat 账户？ <a class="qh text-reset" href="#visibility">注册</a>.
</div>
</div>

<!-- 注册 -->
<div id="visibility" class="shadow-lg p-3 mb-5 bg-body-tertiary rounded card-body font-monospace">
<h5 class="card-title text-center">Mchat 账户注册</h5>
<div class="mb-3">
<input class="form-control" type="text" id="usernames" name="usernams" placeholder="账号">
</div>
<div class="mb-3">
<input class="form-control" type="password" id="passwords" name="passwords" placeholder="密码">
</div>
<div class="d-grid gap-2 col-6 mx-auto">
<button type="submit" id="register-form" class="btn btn-outline-secondary">注册</button>
</div>
<div class="mb-4"></div>
<div class="mb-1 text-center text-muted">
已有 Mchat 账户？ <a class="qh text-reset" href="#hidden">登录</a>.
</div>
</div>

</div></div>


<div class="toast-container position-fixed bottom-0 end-0 p-3">
<div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
<div class="toast-header bg-danger-subtle">
<strong class="me-auto">提示</strong>
</div>
<div class="toast-body bg-transparent" id="message">
</div>
</div>
</div>


<script>
var $ = mdui.$;
$("#visibility").hide();
$(".qh").on('click', function (e) {
var target = $(this).attr("href");
$("#hidden, #visibility").hide();
$(target).show();
});
$('#login-form').on('click', function (e) {
var username=$('#username').val();
var password=$('#password').val();
if(username==='' || password===''){
$('.toast:not(.show)').css('display', 'revert');
$('#message').text('账号密码不能为空！');
setTimeout(function() {
$('.toast:not(.show)').css('display', 'none');
}, 1000);
return;
}else{
$.ajax({
url: 'https://s.jixiejidiguan.top/Api/Mchat/login.php?L',
method: 'POST',
dataType: "json",  
data: {
username: username,
password: password
},
success: function (data) {
$('.toast:not(.show)').css('display', 'revert');
console.log(data.message);
$('#message').text(data.message);
setTimeout(function() {
$('.toast:not(.show)').css('display', 'none');
}, 1000);
if(data.message==="登录成功！"){
document.cookie="username="+data.data.username;
document.cookie="password="+data.data.password;
window.location="/Mchat";
}
return;
}
});
}
});
$('#register-form').on('click', function (e) {
var usernames=$('#usernames').val();
var passwords=$('#passwords').val();
if(usernames==='' || passwords===''){
$('.toast:not(.show)').css('display', 'revert');
$('#message').text('账号密码不能为空！');
setTimeout(function() {
$('.toast:not(.show)').css('display', 'none');
}, 1000);
return;
}else{
$.ajax({
url: 'https://s.jixiejidiguan.top/Api/Mchat/login.php?R',
method: 'POST',
dataType: "json",  
data: {
username: usernames,
password: passwords
},
success: function (data) {
$('.toast:not(.show)').css('display', 'revert');
console.log(data.message);
$('#message').text(data.message);
setTimeout(function() {
$('.toast:not(.show)').css('display', 'none');
}, 1000);
return;
}
});
}
});
</script>
</body>
</html>

